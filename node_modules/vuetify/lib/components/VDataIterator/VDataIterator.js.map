{"version":3,"file":"VDataIterator.js","names":["VFadeTransition","makeDataTableExpandProps","provideExpanded","makeDataTableGroupProps","provideGroupBy","useGroupedItems","useOptions","createPagination","makeDataTablePaginateProps","providePagination","usePaginatedItems","makeDataTableSelectProps","provideSelection","createSort","makeDataTableSortProps","provideSort","useSortedItems","makeDataIteratorItemsProps","useDataIteratorItems","makeComponentProps","makeFilterProps","useFilter","LoaderSlot","useProxiedModel","makeTagProps","makeTransitionProps","MaybeTransition","computed","toRef","genericComponent","propsFactory","useRender","makeVDataIteratorProps","search","String","loading","Boolean","itemsPerPage","transition","component","hideOnLeave","VDataIterator","name","props","emits","value","setup","_ref","slots","groupBy","items","filteredItems","transform","item","raw","initialSortOrder","sortBy","multiSort","mustSort","page","toggleSort","sortByWithGroups","opened","extractRows","isGroupOpen","toggleGroup","sortedItems","flatItems","itemsLength","length","startIndex","stopIndex","pageCount","prevPage","nextPage","setItemsPerPage","setPage","paginatedItems","paginatedItemsWithoutGroups","isSelected","select","selectAll","toggleSelect","allItems","currentPage","isExpanded","toggleExpand","slotProps","itemsCount","groupedItems","_createVNode","tag","_normalizeClass","class","_normalizeStyle","style","default","header","loader","_createElementVNode","footer"],"sources":["../../../src/components/VDataIterator/VDataIterator.tsx"],"sourcesContent":["// Components\nimport { VFadeTransition } from '@/components/transitions'\nimport { makeDataTableExpandProps, provideExpanded } from '@/components/VDataTable/composables/expand'\nimport { makeDataTableGroupProps, provideGroupBy, useGroupedItems } from '@/components/VDataTable/composables/group'\nimport { useOptions } from '@/components/VDataTable/composables/options'\nimport {\n  createPagination,\n  makeDataTablePaginateProps,\n  providePagination,\n  usePaginatedItems,\n} from '@/components/VDataTable/composables/paginate'\nimport { makeDataTableSelectProps, provideSelection } from '@/components/VDataTable/composables/select'\nimport { createSort, makeDataTableSortProps, provideSort, useSortedItems } from '@/components/VDataTable/composables/sort'\n\n// Composables\nimport { makeDataIteratorItemsProps, useDataIteratorItems } from './composables/items'\nimport { makeComponentProps } from '@/composables/component'\nimport { makeFilterProps, useFilter } from '@/composables/filter'\nimport { LoaderSlot } from '@/composables/loader'\nimport { useProxiedModel } from '@/composables/proxiedModel'\nimport { makeTagProps } from '@/composables/tag'\nimport { makeTransitionProps, MaybeTransition } from '@/composables/transition'\n\n// Utilities\nimport { computed, toRef } from 'vue'\nimport { genericComponent, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { Component } from 'vue'\nimport type { DataIteratorItem } from './composables/items'\nimport type { Group, GroupSummary } from '@/components/VDataTable/composables/group'\nimport type { SortItem } from '@/components/VDataTable/composables/sort'\nimport type { LoaderSlotProps } from '@/composables/loader'\nimport type { GenericProps } from '@/util'\n\ntype VDataIteratorSlotProps<T> = {\n  page: number\n  itemsPerPage: number\n  sortBy: readonly SortItem[]\n  pageCount: number\n  toggleSort: ReturnType<typeof provideSort>['toggleSort']\n  prevPage: ReturnType<typeof providePagination>['prevPage']\n  nextPage: ReturnType<typeof providePagination>['nextPage']\n  setPage: ReturnType<typeof providePagination>['setPage']\n  setItemsPerPage: ReturnType<typeof providePagination>['setItemsPerPage']\n  isSelected: ReturnType<typeof provideSelection>['isSelected']\n  select: ReturnType<typeof provideSelection>['select']\n  selectAll: ReturnType<typeof provideSelection>['selectAll']\n  toggleSelect: ReturnType<typeof provideSelection>['toggleSelect']\n  isExpanded: ReturnType<typeof provideExpanded>['isExpanded']\n  toggleExpand: ReturnType<typeof provideExpanded>['toggleExpand']\n  isGroupOpen: ReturnType<typeof provideGroupBy>['isGroupOpen']\n  toggleGroup: ReturnType<typeof provideGroupBy>['toggleGroup']\n  items: readonly DataIteratorItem<T>[]\n  itemsCount: number\n  groupedItems: readonly (DataIteratorItem<T> | Group<DataIteratorItem<T>> | GroupSummary<DataIteratorItem<T>>)[]\n}\n\nexport type VDataIteratorSlots<T> = {\n  default: VDataIteratorSlotProps<T>\n  header: VDataIteratorSlotProps<T>\n  footer: VDataIteratorSlotProps<T>\n  loader: LoaderSlotProps\n  'no-data': never\n}\n\nexport const makeVDataIteratorProps = propsFactory({\n  search: String,\n  loading: Boolean,\n\n  ...makeComponentProps(),\n  ...makeDataIteratorItemsProps(),\n  ...makeDataTableSelectProps(),\n  ...makeDataTableSortProps(),\n  ...makeDataTablePaginateProps({ itemsPerPage: 5 }),\n  ...makeDataTableExpandProps(),\n  ...makeDataTableGroupProps(),\n  ...makeFilterProps(),\n  ...makeTagProps(),\n  ...makeTransitionProps({\n    transition: {\n      component: VFadeTransition as Component,\n      hideOnLeave: true,\n    },\n  }),\n}, 'VDataIterator')\n\nexport const VDataIterator = genericComponent<new <T> (\n  props: {\n    items?: readonly T[]\n  },\n  slots: VDataIteratorSlots<T>,\n) => GenericProps<typeof props, typeof slots>>()({\n  name: 'VDataIterator',\n\n  props: makeVDataIteratorProps(),\n\n  emits: {\n    'update:modelValue': (value: any[]) => true,\n    'update:groupBy': (value: any) => true,\n    'update:page': (value: number) => true,\n    'update:itemsPerPage': (value: number) => true,\n    'update:sortBy': (value: any) => true,\n    'update:options': (value: any) => true,\n    'update:expanded': (value: any) => true,\n    'update:currentItems': (value: any) => true,\n  },\n\n  setup (props, { slots }) {\n    const groupBy = useProxiedModel(props, 'groupBy')\n    const search = toRef(() => props.search)\n\n    const { items } = useDataIteratorItems(props)\n    const { filteredItems } = useFilter(props, items, search, { transform: item => item.raw })\n\n    const { initialSortOrder, sortBy, multiSort, mustSort } = createSort(props)\n    const { page, itemsPerPage } = createPagination(props)\n\n    const { toggleSort } = provideSort({ initialSortOrder, sortBy, multiSort, mustSort, page })\n    const { sortByWithGroups, opened, extractRows, isGroupOpen, toggleGroup } = provideGroupBy({ groupBy, sortBy })\n\n    const { sortedItems } = useSortedItems(props, filteredItems, sortByWithGroups, { transform: item => item.raw })\n    const { flatItems } = useGroupedItems(sortedItems, groupBy, opened, false)\n\n    const itemsLength = toRef(() => flatItems.value.length)\n\n    const {\n      startIndex,\n      stopIndex,\n      pageCount,\n      prevPage,\n      nextPage,\n      setItemsPerPage,\n      setPage,\n    } = providePagination({ page, itemsPerPage, itemsLength })\n    const { paginatedItems } = usePaginatedItems({ items: flatItems, startIndex, stopIndex, itemsPerPage })\n\n    const paginatedItemsWithoutGroups = computed(() => extractRows(paginatedItems.value))\n\n    const {\n      isSelected,\n      select,\n      selectAll,\n      toggleSelect,\n    } = provideSelection(props, { allItems: items, currentPage: paginatedItemsWithoutGroups })\n    const { isExpanded, toggleExpand } = provideExpanded(props)\n\n    useOptions({\n      page,\n      itemsPerPage,\n      sortBy,\n      groupBy,\n      search,\n    })\n\n    const slotProps = computed(() => ({\n      page: page.value,\n      itemsPerPage: itemsPerPage.value,\n      sortBy: sortBy.value,\n      pageCount: pageCount.value,\n      toggleSort,\n      prevPage,\n      nextPage,\n      setPage,\n      setItemsPerPage,\n      isSelected,\n      select,\n      selectAll,\n      toggleSelect,\n      isExpanded,\n      toggleExpand,\n      isGroupOpen,\n      toggleGroup,\n      items: paginatedItemsWithoutGroups.value,\n      itemsCount: filteredItems.value.length,\n      groupedItems: paginatedItems.value,\n    }))\n\n    useRender(() => (\n      <props.tag\n        class={[\n          'v-data-iterator',\n          {\n            'v-data-iterator--loading': props.loading,\n          },\n          props.class,\n        ]}\n        style={ props.style }\n      >\n        { slots.header?.(slotProps.value) }\n\n        <MaybeTransition transition={ props.transition }>\n          { props.loading ? (\n            <LoaderSlot key=\"loader\" name=\"v-data-iterator\" active>\n              { slotProps => slots.loader?.(slotProps) }\n            </LoaderSlot>\n          ) : (\n            <div key=\"items\">\n              { !paginatedItems.value.length\n                ? slots['no-data']?.()\n                : slots.default?.(slotProps.value)\n              }\n            </div>\n          )}\n        </MaybeTransition>\n\n        { slots.footer?.(slotProps.value) }\n      </props.tag>\n    ))\n\n    return {}\n  },\n})\n\nexport type VDataIterator = InstanceType<typeof VDataIterator>\n"],"mappings":"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","ignoreList":[]}