{"version":3,"file":"VDialog.js","names":["VDialogTransition","VDefaultsProvider","VOverlay","makeVOverlayProps","forwardRefs","useProxiedModel","useScopeId","mergeProps","nextTick","ref","watch","genericComponent","omit","propsFactory","useRender","makeVDialogProps","fullscreen","Boolean","scrollable","captureFocus","origin","scrollStrategy","transition","component","zIndex","retainFocus","VDialog","name","props","emits","value","afterEnter","afterLeave","setup","_ref","emit","slots","isActive","scopeId","overlay","onAfterEnter","scrim","contentEl","contains","document","activeElement","focus","preventScroll","onAfterLeave","val","activatorEl","overlayProps","filterProps","activatorProps","contentProps","tabindex","_createVNode","_mergeProps","class","style","$event","height","undefined","width","maxHeight","maxWidth","activator","default","_len","arguments","length","args","Array","_key"],"sources":["../../../src/components/VDialog/VDialog.tsx"],"sourcesContent":["// Styles\nimport './VDialog.sass'\n\n// Components\nimport { VDialogTransition } from '@/components/transitions'\nimport { VDefaultsProvider } from '@/components/VDefaultsProvider'\nimport { VOverlay } from '@/components/VOverlay'\nimport { makeVOverlayProps } from '@/components/VOverlay/VOverlay'\n\n// Composables\nimport { forwardRefs } from '@/composables/forwardRefs'\nimport { useProxiedModel } from '@/composables/proxiedModel'\nimport { useScopeId } from '@/composables/scopeId'\n\n// Utilities\nimport { mergeProps, nextTick, ref, watch } from 'vue'\nimport { genericComponent, omit, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { OverlaySlots } from '@/components/VOverlay/VOverlay'\n\nexport const makeVDialogProps = propsFactory({\n  fullscreen: Boolean,\n  scrollable: Boolean,\n\n  ...omit(makeVOverlayProps({\n    captureFocus: true,\n    origin: 'center center' as const,\n    scrollStrategy: 'block' as const,\n    transition: { component: VDialogTransition },\n    zIndex: 2400,\n    retainFocus: true,\n  }), ['disableInitialFocus']),\n}, 'VDialog')\n\nexport const VDialog = genericComponent<OverlaySlots>()({\n  name: 'VDialog',\n\n  props: makeVDialogProps(),\n\n  emits: {\n    'update:modelValue': (value: boolean) => true,\n    afterEnter: () => true,\n    afterLeave: () => true,\n  },\n\n  setup (props, { emit, slots }) {\n    const isActive = useProxiedModel(props, 'modelValue')\n    const { scopeId } = useScopeId()\n\n    const overlay = ref<VOverlay>()\n\n    function onAfterEnter () {\n      emit('afterEnter')\n      if (\n        (props.scrim || props.retainFocus) &&\n        overlay.value?.contentEl &&\n        !overlay.value.contentEl.contains(document.activeElement)\n      ) {\n        overlay.value.contentEl.focus({ preventScroll: true })\n      }\n    }\n\n    function onAfterLeave () {\n      emit('afterLeave')\n    }\n\n    watch(isActive, async val => {\n      if (!val) {\n        await nextTick()\n        overlay.value!.activatorEl?.focus({ preventScroll: true })\n      }\n    })\n\n    useRender(() => {\n      const overlayProps = VOverlay.filterProps(props)\n      const activatorProps = mergeProps({\n        'aria-haspopup': 'dialog',\n      }, props.activatorProps)\n      const contentProps = mergeProps({\n        tabindex: -1,\n      }, props.contentProps)\n\n      return (\n        <VOverlay\n          ref={ overlay }\n          class={[\n            'v-dialog',\n            {\n              'v-dialog--fullscreen': props.fullscreen,\n              'v-dialog--scrollable': props.scrollable,\n            },\n            props.class,\n          ]}\n          style={ props.style }\n          { ...overlayProps }\n          v-model={ isActive.value }\n          aria-modal=\"true\"\n          activatorProps={ activatorProps }\n          contentProps={ contentProps }\n          height={ !props.fullscreen ? props.height : undefined }\n          width={ !props.fullscreen ? props.width : undefined }\n          maxHeight={ !props.fullscreen ? props.maxHeight : undefined }\n          maxWidth={ !props.fullscreen ? props.maxWidth : undefined }\n          role=\"dialog\"\n          onAfterEnter={ onAfterEnter }\n          onAfterLeave={ onAfterLeave }\n          { ...scopeId }\n        >\n          {{\n            activator: slots.activator,\n            default: (...args) => (\n              <VDefaultsProvider root=\"VDialog\">\n                { slots.default?.(...args) }\n              </VDefaultsProvider>\n            ),\n          }}\n        </VOverlay>\n      )\n    })\n\n    return forwardRefs({}, overlay)\n  },\n})\n\nexport type VDialog = InstanceType<typeof VDialog>\n"],"mappings":"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","ignoreList":[]}