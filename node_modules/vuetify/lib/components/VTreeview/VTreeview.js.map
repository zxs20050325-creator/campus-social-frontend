{"version":3,"file":"VTreeview.js","names":["makeVTreeviewChildrenProps","VTreeviewChildren","makeVListProps","useListItems","VList","VListItem","useLocale","provideDefaults","makeFilterProps","useFilter","useProxiedModel","computed","provide","ref","toRaw","toRef","genericComponent","omit","propsFactory","useRender","VTreeviewSymbol","flatten","items","flat","arguments","length","undefined","item","push","children","makeVTreeviewProps","openAll","Boolean","indentLines","String","search","hideNoData","noDataText","type","default","filterKeys","collapseIcon","expandIcon","slim","modelValue","Array","VTreeview","name","props","emits","val","value","setup","_ref","slots","emit","t","activeColor","baseColor","color","activated","_selected","selected","get","set","vListRef","opened","flatItems","filteredItems","visibleIds","getPath","Set","flatMap","itemVal","returnObject","raw","getChildren","map","id","arr","queue","slice","child","shift","ids","i","concat","VTreeviewGroup","VTreeviewItem","activeClass","density","disabled","lines","variant","listProps","filterProps","treeviewChildrenProps","indentLinesVariant","_createVNode","_mergeProps","fluid","class","style","$event","size"],"sources":["../../../src/components/VTreeview/VTreeview.tsx"],"sourcesContent":["// Components\nimport { makeVTreeviewChildrenProps, VTreeviewChildren } from './VTreeviewChildren'\nimport { makeVListProps, useListItems, VList } from '@/components/VList/VList'\nimport { VListItem } from '@/components/VList/VListItem'\n\n// Composables\nimport { useLocale } from '@/composables'\nimport { provideDefaults } from '@/composables/defaults'\nimport { makeFilterProps, useFilter } from '@/composables/filter'\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Utilities\nimport { computed, provide, ref, toRaw, toRef } from 'vue'\nimport { genericComponent, omit, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\nimport { VTreeviewSymbol } from './shared'\nimport type { VTreeviewChildrenSlots } from './VTreeviewChildren'\nimport type { InternalListItem } from '@/components/VList/VList'\nimport type { ListItem } from '@/composables/list-items'\nimport type { GenericProps, IndentLinesVariant } from '@/util'\n\nfunction flatten (items: ListItem[], flat: ListItem[] = []) {\n  for (const item of items) {\n    flat.push(item)\n    if (item.children) flatten(item.children, flat)\n  }\n  return flat\n}\n\nexport const makeVTreeviewProps = propsFactory({\n  openAll: Boolean,\n  indentLines: [Boolean, String] as PropType<boolean | IndentLinesVariant>,\n  search: String,\n  hideNoData: Boolean,\n  noDataText: {\n    type: String,\n    default: '$vuetify.noDataText',\n  },\n\n  ...makeFilterProps({ filterKeys: ['title'] }),\n  ...omit(makeVTreeviewChildrenProps(), [\n    'index',\n    'path',\n    'indentLinesVariant',\n    'parentIndentLines',\n    'isLastGroup',\n  ]),\n  ...omit(makeVListProps({\n    collapseIcon: '$treeviewCollapse',\n    expandIcon: '$treeviewExpand',\n    slim: true,\n  }), ['nav', 'openStrategy']),\n\n  modelValue: Array,\n}, 'VTreeview')\n\nexport const VTreeview = genericComponent<new <T, O, A, S, M>(\n  props: {\n    items?: T[]\n    opened?: O\n    activated?: A\n    selected?: S\n    modelValue?: M\n    'onUpdate:opened'?: (value: O) => void\n    'onUpdate:activated'?: (value: A) => void\n    'onUpdate:selected'?: (value: S) => void\n    'onUpdate:modelValue'?: (value: M) => void\n  },\n  slots: VTreeviewChildrenSlots<T> & {\n    'no-data': never\n  }\n) => GenericProps<typeof props, typeof slots>>()({\n  name: 'VTreeview',\n\n  props: makeVTreeviewProps(),\n\n  emits: {\n    'update:opened': (val: unknown) => true,\n    'update:activated': (val: unknown) => true,\n    'update:selected': (val: unknown) => true,\n    'update:modelValue': (val: unknown) => true,\n    'click:open': (value: { id: unknown, value: boolean, path: unknown[] }) => true,\n    'click:select': (value: { id: unknown, value: boolean, path: unknown[] }) => true,\n  },\n\n  setup (props, { slots, emit }) {\n    const { t } = useLocale()\n    const { items } = useListItems(props)\n    const activeColor = toRef(() => props.activeColor)\n    const baseColor = toRef(() => props.baseColor)\n    const color = toRef(() => props.color)\n    const activated = useProxiedModel(props, 'activated')\n    const _selected = useProxiedModel(props, 'selected')\n\n    const selected = computed({\n      get: () => props.modelValue ?? _selected.value,\n      set (val) {\n        _selected.value = val\n        emit('update:modelValue', val)\n      },\n    })\n\n    const vListRef = ref<VList>()\n\n    const opened = computed(() => props.openAll ? openAll(items.value) : props.opened)\n    const flatItems = computed(() => flatten(items.value))\n    const search = toRef(() => props.search)\n    const { filteredItems } = useFilter(props, flatItems, search)\n    const visibleIds = computed(() => {\n      if (!search.value) return null\n      const getPath = vListRef.value?.getPath\n      if (!getPath) return null\n      return new Set(filteredItems.value.flatMap(item => {\n        const itemVal = props.returnObject ? item.raw : item.props.value\n        return [\n          ...getPath(itemVal),\n          ...getChildren(itemVal),\n        ].map(toRaw)\n      }))\n    })\n\n    function getChildren (id: unknown) {\n      const arr: unknown[] = []\n      const queue = ((vListRef.value?.children.get(id) ?? []).slice())\n      while (queue.length) {\n        const child = queue.shift()\n        if (!child) continue\n        arr.push(child)\n        queue.push(...((vListRef.value?.children.get(child) ?? []).slice()))\n      }\n      return arr\n    }\n\n    function openAll (items: InternalListItem<any>[]) {\n      let ids: any[] = []\n\n      for (const i of items) {\n        if (!i.children) continue\n\n        ids.push(props.returnObject ? toRaw(i.raw) : i.value)\n\n        if (i.children) {\n          ids = ids.concat(openAll(i.children))\n        }\n      }\n\n      return ids\n    }\n\n    provide(VTreeviewSymbol, { visibleIds })\n\n    provideDefaults({\n      VTreeviewGroup: {\n        activeColor,\n        baseColor,\n        color,\n        collapseIcon: toRef(() => props.collapseIcon),\n        expandIcon: toRef(() => props.expandIcon),\n      },\n      VTreeviewItem: {\n        activeClass: toRef(() => props.activeClass),\n        activeColor,\n        baseColor,\n        color,\n        density: toRef(() => props.density),\n        disabled: toRef(() => props.disabled),\n        lines: toRef(() => props.lines),\n        variant: toRef(() => props.variant),\n      },\n    })\n\n    useRender(() => {\n      const listProps = VList.filterProps(props)\n      const treeviewChildrenProps = VTreeviewChildren.filterProps(props)\n      const indentLinesVariant = typeof props.indentLines === 'boolean' ? 'default' : props.indentLines\n\n      return (\n        <VList\n          ref={ vListRef }\n          { ...listProps }\n          class={[\n            'v-treeview',\n            {\n              'v-treeview--fluid': props.fluid,\n            },\n            props.class,\n          ]}\n          openStrategy=\"multiple\"\n          style={ props.style }\n          opened={ opened.value }\n          v-model:activated={ activated.value }\n          v-model:selected={ selected.value }\n        >\n          { visibleIds.value?.size === 0 && !props.hideNoData && (\n            slots['no-data']?.() ?? (<VListItem key=\"no-data\" title={ t(props.noDataText) } />)\n          )}\n          <VTreeviewChildren\n            { ...treeviewChildrenProps }\n            density={ props.density }\n            returnObject={ props.returnObject }\n            items={ items.value }\n            parentIndentLines={ props.indentLines ? [] : undefined }\n            indentLinesVariant={ indentLinesVariant }\n            v-slots={ slots }\n          ></VTreeviewChildren>\n        </VList>\n      )\n    })\n\n    return { }\n  },\n})\n\nexport type VTreeview = InstanceType<typeof VTreeview>\n"],"mappings":"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","ignoreList":[]}