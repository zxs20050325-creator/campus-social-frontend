{"version":3,"file":"VCalendarWeekly.js","names":["VIconBtn","makeCalendarBaseProps","useCalendarBase","useTheme","computed","createDayList","createNativeLocaleFormatter","getDayIdentifier","validateNumber","defineComponent","getPrefixedEventHandlers","noop","useRender","VCalendarWeekly","name","props","minWeeks","validate","default","monthFormat","Function","showWeek","Boolean","color","String","shortWeekdays","type","showMonthOnFirst","shortMonths","hideHeader","setup","_ref","slots","attrs","base","theme","parsedMinWeeks","parseInt","days","minDays","value","parsedWeekdays","length","start","getStartOfWeek","parsedStart","end","getEndOfWeek","parsedEnd","times","today","weekdaySkips","Number","MAX_SAFE_INTEGER","todayWeek","monthFormatter","locale","current","_tms","short","timeZone","month","isOutside","day","dayIdentifier","genHead","_createElementVNode","genHeadDays","header","map","genHeadDay","unshift","index","outside","present","undefined","_mergeProps","getColorProps","text","date","getRelativeClasses","weekdayFormatter","genWeeks","daysValue","weekDays","weeks","i","push","genWeek","slice","getWeekNumber","week","weekNumber","weekNodes","genDay","genWeekNumber","determineDay","events","nativeEvent","genDayLabel","genDayLabelButton","hasMonth","_createVNode","dayFormatter","_normalizeClass","themeClasses","e","preventDefault"],"sources":["../../../src/components/VCalendar/VCalendarWeekly.tsx"],"sourcesContent":["// Components\nimport { VIconBtn } from '@/labs/VIconBtn'\n\n// Composables\nimport { makeCalendarBaseProps, useCalendarBase } from './composables/calendarBase'\nimport { useTheme } from '@/composables'\n\n// Utilities\nimport { computed } from 'vue'\nimport {\n  createDayList,\n  createNativeLocaleFormatter,\n  getDayIdentifier,\n  validateNumber,\n} from './util/timestamp'\nimport { defineComponent, getPrefixedEventHandlers, noop, useRender } from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\nimport type { CalendarFormatter, CalendarTimestamp } from './types'\n\nexport const VCalendarWeekly = defineComponent({\n  name: 'VCalendarWeekly',\n\n  props: {\n    minWeeks: {\n      validate: validateNumber,\n      default: 1,\n    },\n    monthFormat: Function as PropType<CalendarFormatter>,\n    showWeek: Boolean,\n    color: String,\n    shortWeekdays: {\n      type: Boolean,\n      default: true,\n    },\n    showMonthOnFirst: {\n      type: Boolean,\n      default: true,\n    },\n    shortMonths: {\n      type: Boolean,\n      default: true,\n    },\n    hideHeader: Boolean,\n\n    ...makeCalendarBaseProps(),\n  },\n\n  setup (props, { slots, attrs }) {\n    const base = useCalendarBase(props)\n\n    const theme = useTheme()\n\n    const parsedMinWeeks = computed((): number => {\n      return parseInt(String(props.minWeeks))\n    })\n\n    const days = computed((): CalendarTimestamp[] => {\n      const minDays = parsedMinWeeks.value * base.parsedWeekdays.value.length\n      const start = base.getStartOfWeek(base.parsedStart.value)\n      const end = base.getEndOfWeek(base.parsedEnd.value)\n\n      return createDayList(\n        start,\n        end,\n        base.times.today,\n        base.weekdaySkips.value,\n        Number.MAX_SAFE_INTEGER,\n        minDays\n      )\n    })\n\n    const todayWeek = computed((): CalendarTimestamp[] => {\n      const today = base.times.today\n      const start = base.getStartOfWeek(today)\n      const end = base.getEndOfWeek(today)\n\n      return createDayList(\n        start,\n        end,\n        today,\n        base.weekdaySkips.value,\n        base.parsedWeekdays.value.length,\n        base.parsedWeekdays.value.length\n      )\n    })\n\n    const monthFormatter = computed((): CalendarFormatter => {\n      if (props.monthFormat) {\n        // TODO: what happens when this is a string?\n        return props.monthFormat as CalendarFormatter\n      }\n\n      return createNativeLocaleFormatter(\n        base.locale.current.value,\n        (_tms, short) => ({ timeZone: 'UTC', month: short ? 'short' : 'long' })\n      )\n    })\n\n    function isOutside (day: CalendarTimestamp): boolean {\n      const dayIdentifier = getDayIdentifier(day)\n\n      return dayIdentifier < getDayIdentifier(base.parsedStart.value) ||\n             dayIdentifier > getDayIdentifier(base.parsedEnd.value)\n    }\n\n    function genHead () {\n      return (\n        <div class=\"v-calendar-weekly__head\" role=\"row\">\n          { genHeadDays() }\n        </div>\n      )\n    }\n\n    function genHeadDays () {\n      const header = todayWeek.value.map(genHeadDay)\n\n      if (props.showWeek) {\n        header.unshift(\n          <div class=\"v-calendar-weekly__head-weeknumber\" />\n        )\n      }\n\n      return header\n    }\n\n    function genHeadDay (day: CalendarTimestamp, index: number) {\n      const outside = isOutside(days.value[index])\n      const color = day.present ? props.color : undefined\n\n      return (\n        <div\n          { ...base.getColorProps({ text: color }) }\n          key={ day.date }\n          class={['v-calendar-weekly__head-weekday', base.getRelativeClasses(day, outside)]}\n          role=\"columnheader\"\n        >\n          { base.weekdayFormatter.value(day, props.shortWeekdays) }\n        </div>\n      )\n    }\n\n    function genWeeks () {\n      const daysValue = days.value\n      const weekDays = base.parsedWeekdays.value.length\n      const weeks: any[] = []\n\n      for (let i = 0; i < daysValue.length; i += weekDays) {\n        weeks.push(genWeek(daysValue.slice(i, i + weekDays), getWeekNumber(daysValue[i])))\n      }\n\n      return weeks\n    }\n\n    function genWeek (week: CalendarTimestamp[], weekNumber: number) {\n      const weekNodes = week.map((day, index) => genDay(day, index, week))\n\n      if (props.showWeek) {\n        weekNodes.unshift(genWeekNumber(weekNumber))\n      }\n\n      return (\n        <div\n          key={ week[0].date }\n          class=\"v-calendar-weekly__week\"\n          role=\"row\"\n        >\n          { weekNodes }\n        </div>\n      )\n    }\n\n    function getWeekNumber (determineDay: CalendarTimestamp) {\n      return base.getWeekNumber(determineDay)\n    }\n\n    function genWeekNumber (weekNumber: number) {\n      return (\n        <div class=\"v-calendar-weekly__weeknumber\">\n          <small>{ String(weekNumber) }</small>\n        </div>\n      )\n    }\n\n    function genDay (day: CalendarTimestamp, index: number, week: CalendarTimestamp[]) {\n      const outside = isOutside(day)\n      const events = getPrefixedEventHandlers(attrs, ':day', nativeEvent => {\n        return { nativeEvent, ...day }\n      })\n\n      return (\n        <div\n          key={ day.date }\n          class={['v-calendar-weekly__day', base.getRelativeClasses(day, outside)]}\n          role=\"cell\"\n          { ...events }\n        >\n          { genDayLabel(day) }\n          { slots.day?.({ outside, index, week, ...day }) }\n        </div>\n      )\n    }\n\n    function genDayLabel (day: CalendarTimestamp) {\n      return (\n        <div class=\"v-calendar-weekly__day-label\">\n          { slots['day-label']?.(day) ?? genDayLabelButton(day) }\n        </div>\n      )\n    }\n\n    function genDayLabelButton (day: CalendarTimestamp) {\n      const hasMonth = day.day === 1 && props.showMonthOnFirst\n      const events = getPrefixedEventHandlers(attrs, ':date', nativeEvent => ({ nativeEvent, ...day }))\n\n      return (\n        <VIconBtn\n          active={ day.present }\n          activeColor={ props.color }\n          variant=\"outlined\"\n          baseVariant=\"text\"\n          onUpdate:active={ noop }\n          { ...events }\n        >\n          { hasMonth\n            ? monthFormatter.value(day, props.shortMonths) + ' ' + base.dayFormatter.value(day, false)\n            : base.dayFormatter.value(day, false)\n          }\n        </VIconBtn>\n      )\n    }\n\n    useRender(() => (\n      <div\n        class={['v-calendar-weekly', theme.themeClasses.value]}\n        onDragstart={ (e: MouseEvent) => e.preventDefault() }\n      >\n        { !props.hideHeader ? genHead() : undefined }\n        { genWeeks() }\n      </div>\n    ))\n\n    return {\n      ...base,\n      days,\n      todayWeek,\n      monthFormatter,\n      isOutside,\n    }\n  },\n})\n\nexport type VCalendarWeekly = InstanceType<typeof VCalendarWeekly>\n"],"mappings":"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","ignoreList":[]}