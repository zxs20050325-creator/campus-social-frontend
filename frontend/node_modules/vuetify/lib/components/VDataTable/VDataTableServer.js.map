{"version":3,"file":"VDataTableServer.js","names":["makeDataTableProps","makeVDataTableFooterProps","VDataTableFooter","VDataTableHeaders","VDataTableRows","VDivider","VTable","provideExpanded","createGroupBy","provideGroupBy","useGroupedItems","createHeaders","useDataTableItems","useOptions","createPagination","makeDataTablePaginateProps","providePagination","provideSelection","createSort","provideSort","provideDefaults","computed","provide","toRef","toRefs","genericComponent","omit","propsFactory","useRender","makeVDataTableServerProps","itemsLength","type","Number","String","required","VDataTableServer","name","props","emits","value","page","sortBy","options","setup","_ref","attrs","slots","groupBy","initialSortOrder","multiSort","mustSort","itemsPerPage","disableSort","parseInt","columns","headers","showSelect","showExpand","items","toggleSort","opened","isGroupOpen","toggleGroup","extractRows","pageCount","setItemsPerPage","flatItems","isSelected","select","selectAll","toggleSelect","someSelected","allSelected","allItems","currentPage","isExpanded","toggleExpand","itemsWithoutGroups","search","hideNoData","noDataText","loading","loadingText","slotProps","map","item","raw","internalItems","groupedItems","dataTableFooterProps","filterProps","dataTableHeadersProps","dataTableRowsProps","tableProps","_createVNode","_mergeProps","class","style","fixedHeader","sticky","top","default","_createElementVNode","_Fragment","colgroup","hideDefaultHeader","thead","hideDefaultBody","body","tbody","tfoot","bottom","hideDefaultFooter","prepend"],"sources":["../../../src/components/VDataTable/VDataTableServer.tsx"],"sourcesContent":["// Components\nimport { makeDataTableProps } from './VDataTable'\nimport { makeVDataTableFooterProps, VDataTableFooter } from './VDataTableFooter'\nimport { VDataTableHeaders } from './VDataTableHeaders'\nimport { VDataTableRows } from './VDataTableRows'\nimport { VDivider } from '@/components/VDivider'\nimport { VTable } from '@/components/VTable'\n\n// Composables\nimport { provideExpanded } from './composables/expand'\nimport { createGroupBy, provideGroupBy, useGroupedItems } from './composables/group'\nimport { createHeaders } from './composables/headers'\nimport { useDataTableItems } from './composables/items'\nimport { useOptions } from './composables/options'\nimport { createPagination, makeDataTablePaginateProps, providePagination } from './composables/paginate'\nimport { provideSelection } from './composables/select'\nimport { createSort, provideSort } from './composables/sort'\nimport { provideDefaults } from '@/composables/defaults'\n\n// Utilities\nimport { computed, provide, toRef, toRefs } from 'vue'\nimport { genericComponent, omit, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { DeepReadonly } from 'vue'\nimport type { VDataTableSlotProps, VDataTableSlots } from './VDataTable'\nimport type { CellProps, DataTableHeader, RowProps } from '@/components/VDataTable/types'\nimport type { GenericProps, SelectItemKey } from '@/util'\n\nexport const makeVDataTableServerProps = propsFactory({\n  itemsLength: {\n    type: [Number, String],\n    required: true,\n  },\n\n  ...makeDataTablePaginateProps(),\n  ...makeDataTableProps(),\n  ...makeVDataTableFooterProps(),\n}, 'VDataTableServer')\n\ntype ItemType<T> = T extends readonly (infer U)[] ? U : never\n\nexport const VDataTableServer = genericComponent<new <T extends readonly any[], V>(\n  props: {\n    items?: T\n    itemValue?: SelectItemKey<ItemType<T>>\n    rowProps?: RowProps<ItemType<T>>\n    cellProps?: CellProps<ItemType<T>>\n    itemSelectable?: SelectItemKey<ItemType<T>>\n    headers?: DeepReadonly<DataTableHeader<ItemType<T>>[]>\n    modelValue?: V\n    'onUpdate:modelValue'?: (value: V) => void\n  },\n  slots: VDataTableSlots<ItemType<T>>,\n) => GenericProps<typeof props, typeof slots>>()({\n  name: 'VDataTableServer',\n\n  props: makeVDataTableServerProps(),\n\n  emits: {\n    'update:modelValue': (value: any[]) => true,\n    'update:page': (page: number) => true,\n    'update:itemsPerPage': (page: number) => true,\n    'update:sortBy': (sortBy: any) => true,\n    'update:options': (options: any) => true,\n    'update:expanded': (options: any) => true,\n    'update:groupBy': (value: any) => true,\n  },\n\n  setup (props, { attrs, slots }) {\n    const { groupBy } = createGroupBy(props)\n    const { initialSortOrder, sortBy, multiSort, mustSort } = createSort(props)\n    const { page, itemsPerPage } = createPagination(props)\n    const { disableSort } = toRefs(props)\n    const itemsLength = computed(() => parseInt(props.itemsLength, 10))\n\n    const { columns, headers } = createHeaders(props, {\n      groupBy,\n      showSelect: toRef(() => props.showSelect),\n      showExpand: toRef(() => props.showExpand),\n    })\n\n    const { items } = useDataTableItems(props, columns)\n\n    const { toggleSort } = provideSort({ initialSortOrder, sortBy, multiSort, mustSort, page })\n\n    const { opened, isGroupOpen, toggleGroup, extractRows } = provideGroupBy({ groupBy, sortBy, disableSort })\n\n    const { pageCount, setItemsPerPage } = providePagination({ page, itemsPerPage, itemsLength })\n\n    const { flatItems } = useGroupedItems(items, groupBy, opened, () => !!slots['group-summary'])\n\n    const { isSelected, select, selectAll, toggleSelect, someSelected, allSelected } = provideSelection(props, {\n      allItems: items,\n      currentPage: items,\n    })\n\n    const { isExpanded, toggleExpand } = provideExpanded(props)\n\n    const itemsWithoutGroups = computed(() => extractRows(items.value))\n\n    useOptions({\n      page,\n      itemsPerPage,\n      sortBy,\n      groupBy,\n      search: toRef(() => props.search),\n    })\n\n    provide('v-data-table', {\n      toggleSort,\n      sortBy,\n    })\n\n    provideDefaults({\n      VDataTableRows: {\n        hideNoData: toRef(() => props.hideNoData),\n        noDataText: toRef(() => props.noDataText),\n        loading: toRef(() => props.loading),\n        loadingText: toRef(() => props.loadingText),\n      },\n    })\n\n    const slotProps = computed<VDataTableSlotProps<any>>(() => ({\n      page: page.value,\n      itemsPerPage: itemsPerPage.value,\n      sortBy: sortBy.value,\n      pageCount: pageCount.value,\n      toggleSort,\n      setItemsPerPage,\n      someSelected: someSelected.value,\n      allSelected: allSelected.value,\n      isSelected,\n      select,\n      selectAll,\n      toggleSelect,\n      isExpanded,\n      toggleExpand,\n      isGroupOpen,\n      toggleGroup,\n      items: itemsWithoutGroups.value.map(item => item.raw),\n      internalItems: itemsWithoutGroups.value,\n      groupedItems: flatItems.value,\n      columns: columns.value,\n      headers: headers.value,\n    }))\n\n    useRender(() => {\n      const dataTableFooterProps = VDataTableFooter.filterProps(props)\n      const dataTableHeadersProps = VDataTableHeaders.filterProps(omit(props, ['multiSort']))\n      const dataTableRowsProps = VDataTableRows.filterProps(props)\n      const tableProps = VTable.filterProps(props)\n\n      return (\n        <VTable\n          class={[\n            'v-data-table',\n            {\n              'v-data-table--loading': props.loading,\n            },\n            props.class,\n          ]}\n          style={ props.style }\n          { ...tableProps }\n          fixedHeader={ props.fixedHeader || props.sticky }\n        >\n          {{\n            top: () => slots.top?.(slotProps.value),\n            default: () => slots.default ? slots.default(slotProps.value) : (\n              <>\n                { slots.colgroup?.(slotProps.value) }\n                { !props.hideDefaultHeader && (\n                  <thead key=\"thead\" class=\"v-data-table__thead\" role=\"rowgroup\">\n                    <VDataTableHeaders\n                      { ...dataTableHeadersProps }\n                      multiSort={ !!props.multiSort }\n                      v-slots={ slots }\n                    />\n                  </thead>\n                )}\n                { slots.thead?.(slotProps.value) }\n                { !props.hideDefaultBody && (\n                  <tbody class=\"v-data-table__tbody\" role=\"rowgroup\">\n                    { slots['body.prepend']?.(slotProps.value) }\n                    { slots.body ? slots.body(slotProps.value) : (\n                      <VDataTableRows\n                        { ...attrs }\n                        { ...dataTableRowsProps }\n                        items={ flatItems.value }\n                        v-slots={ slots }\n                      />\n                    )}\n                    { slots['body.append']?.(slotProps.value) }\n                  </tbody>\n                )}\n                { slots.tbody?.(slotProps.value) }\n                { slots.tfoot?.(slotProps.value) }\n              </>\n            ),\n            bottom: () => slots.bottom ? slots.bottom(slotProps.value) : !props.hideDefaultFooter && (\n              <>\n                <VDivider />\n\n                <VDataTableFooter\n                  { ...dataTableFooterProps }\n                  v-slots={{\n                    prepend: slots['footer.prepend'],\n                  }}\n                />\n              </>\n            ),\n          }}\n        </VTable>\n      )\n    })\n  },\n})\n\nexport type VDataTableServer = InstanceType<typeof VDataTableServer>\n"],"mappings":"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","ignoreList":[]}