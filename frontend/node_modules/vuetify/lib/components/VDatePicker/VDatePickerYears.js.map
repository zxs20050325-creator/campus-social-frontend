{"version":3,"file":"VDatePickerYears.js","names":["VBtn","useDate","useProxiedModel","vIntersect","computed","shallowRef","watchEffect","convertToUnit","createRange","genericComponent","propsFactory","templateRef","useRender","makeVDatePickerYearsProps","color","String","height","Number","min","max","modelValue","allowedYears","Array","Function","VDatePickerYears","name","props","directives","emits","year","setup","_ref","emit","slots","adapter","model","hasFocusedItem","years","getYear","date","startOfYear","setYear","map","i","text","format","value","isDisabled","isYearAllowed","yearRef","focusSelectedYear","el","scrollIntoView","block","isArray","length","includes","_withDirectives","_createElementVNode","onFocus","focus","onFocusin","onFocusout","btnProps","ref","undefined","active","rounded","disabled","variant","onClick","_createVNode","_mergeProps","handler","once"],"sources":["../../../src/components/VDatePicker/VDatePickerYears.tsx"],"sourcesContent":["// Styles\nimport './VDatePickerYears.sass'\n\n// Components\nimport { VBtn } from '@/components/VBtn'\n\n// Composables\nimport { useDate } from '@/composables/date'\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Directives\nimport vIntersect from '@/directives/intersect'\n\n// Utilities\nimport { computed, shallowRef, watchEffect } from 'vue'\nimport { convertToUnit, createRange, genericComponent, propsFactory, templateRef, useRender } from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\n\n// Types\nexport type VDatePickerYearsSlots = {\n  year: {\n    year: {\n      text: string\n      value: number\n    }\n    i: number\n    props: {\n      active: boolean\n      color?: string\n      rounded: boolean\n      text: string\n      variant: 'flat' | 'text'\n      onClick: () => void\n    }\n  }\n}\n\nexport const makeVDatePickerYearsProps = propsFactory({\n  color: String,\n  height: [String, Number],\n  min: null as any as PropType<unknown>,\n  max: null as any as PropType<unknown>,\n  modelValue: Number,\n  allowedYears: [Array, Function] as PropType<number[] | ((date: number) => boolean)>,\n}, 'VDatePickerYears')\n\nexport const VDatePickerYears = genericComponent<VDatePickerYearsSlots>()({\n  name: 'VDatePickerYears',\n\n  props: makeVDatePickerYearsProps(),\n\n  directives: { vIntersect },\n\n  emits: {\n    'update:modelValue': (year: number) => true,\n  },\n\n  setup (props, { emit, slots }) {\n    const adapter = useDate()\n    const model = useProxiedModel(props, 'modelValue')\n    const hasFocusedItem = shallowRef(false)\n    const years = computed(() => {\n      const year = adapter.getYear(adapter.date())\n\n      let min = year - 100\n      let max = year + 52\n\n      if (props.min) {\n        min = adapter.getYear(adapter.date(props.min))\n      }\n\n      if (props.max) {\n        max = adapter.getYear(adapter.date(props.max))\n      }\n\n      let date = adapter.startOfYear(adapter.date())\n\n      date = adapter.setYear(date, min)\n\n      return createRange(max - min + 1, min).map(i => {\n        const text = adapter.format(date, 'year')\n        date = adapter.setYear(date, adapter.getYear(date) + 1)\n\n        return {\n          text,\n          value: i,\n          isDisabled: !isYearAllowed(i),\n        }\n      })\n    })\n\n    watchEffect(() => {\n      model.value = model.value ?? adapter.getYear(adapter.date())\n    })\n\n    const yearRef = templateRef()\n\n    function focusSelectedYear () {\n      yearRef.el?.scrollIntoView({ block: 'center' })\n    }\n\n    function isYearAllowed (year: number) {\n      if (Array.isArray(props.allowedYears) && props.allowedYears.length) {\n        return props.allowedYears.includes(year)\n      }\n\n      if (typeof props.allowedYears === 'function') {\n        return props.allowedYears(year)\n      }\n\n      return true\n    }\n\n    useRender(() => (\n      <div\n        class=\"v-date-picker-years\"\n        v-intersect={[{\n          handler: focusSelectedYear,\n        }, null, ['once']]}\n        style={{\n          height: convertToUnit(props.height),\n        }}\n      >\n        <div\n          class=\"v-date-picker-years__content\"\n          onFocus={ () => yearRef.el?.focus() }\n          onFocusin={ () => hasFocusedItem.value = true }\n          onFocusout={ () => hasFocusedItem.value = false }\n          tabindex={ hasFocusedItem.value ? -1 : 0 }\n        >\n          { years.value.map((year, i) => {\n            const btnProps = {\n              ref: model.value === year.value ? yearRef : undefined,\n              active: model.value === year.value,\n              color: model.value === year.value ? props.color : undefined,\n              rounded: true,\n              text: year.text,\n              disabled: year.isDisabled,\n              variant: model.value === year.value ? 'flat' : 'text',\n              onClick: () => {\n                if (model.value === year.value) {\n                  emit('update:modelValue', model.value)\n                  return\n                }\n                model.value = year.value\n              },\n            } as const\n\n            return slots.year?.({\n              year,\n              i,\n              props: btnProps,\n            }) ?? (\n              <VBtn\n                key=\"month\"\n                { ...btnProps }\n              />\n            )\n          })}\n        </div>\n      </div>\n    ))\n\n    return {}\n  },\n})\n\nexport type VDatePickerYears = InstanceType<typeof VDatePickerYears>\n"],"mappings":"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","ignoreList":[]}