{"version":3,"file":"VPie.js","names":["makeVPieSegmentProps","VPieSegment","VPieTooltip","VAvatar","VChip","VChipGroup","VDefaultsProvider","useColor","makeDensityProps","vClickOutside","computed","shallowRef","toRef","watch","formatTextTemplate","convertToUnit","genericComponent","pick","propsFactory","makeVPieProps","title","String","bgColor","items","type","Array","default","palette","itemKey","itemValue","itemTitle","size","Number","rotate","gaugeCut","legend","Boolean","Object","tooltip","VPie","name","directives","props","setup","_ref","slots","legendConfig","visible","position","textFormat","colorClasses","colorStyles","background","textColorStyles","value","legendAvatarSize","comfortable","compact","density","legendDirection","includes","legendMode","legendTextFormatFunction","item","arcs","filter","map","index","key","color","colorFromPalette","pattern","patternFromPalette","raw","visibleItemsKeys","length","a","immediate","visibleItems","isVisible","total","reduce","sum","gaugeOffset","Math","cos","PI","min","rotateDeg","arcOffset","slice","acc","s","arcSize","v","undefined","paletteItem","toggle","x","tooltipItem","tooltipVisible","tooltipTarget","mouseLeaveTimeout","setItemActive","active","forEach","isActive","setTooltip","clearTimeout","setTimeout","frame","onSvgMousemove","_ref2","clientX","clientY","cancelAnimationFrame","requestAnimationFrame","onSvgTouchstart","_ref3","touches","onSvgClickOutside","segmentProps","defaultTooltipTransition","duration","tooltipProps","modelValue","titleFormat","subtitleFormat","transition","offset","target","legendDefaults","direction","tooltipDefaults","avatarSize","avatarSlot","_ref4","_createVNode","_createElementVNode","_normalizeClass","_normalizeStyle","transform","marginBottom","_withDirectives","_mergeProps","val","onTouchend","handler","center","$event","prepend","slotProps"],"sources":["../../../src/labs/VPie/VPie.tsx"],"sourcesContent":["// Styles\nimport './VPie.sass'\n\n// Components\nimport { makeVPieSegmentProps, VPieSegment } from './VPieSegment'\nimport { VPieTooltip } from './VPieTooltip'\nimport { VAvatar } from '@/components/VAvatar'\nimport { VChip } from '@/components/VChip'\nimport { VChipGroup } from '@/components/VChipGroup'\nimport { VDefaultsProvider } from '@/components/VDefaultsProvider'\n\n// Composables\nimport { useColor } from '@/composables/color'\nimport { makeDensityProps } from '@/composables/density'\n\n// Directives\nimport vClickOutside from '@/directives/click-outside'\n\n// Utilities\nimport { computed, shallowRef, toRef, watch } from 'vue'\nimport { formatTextTemplate } from './utils'\nimport { convertToUnit, genericComponent, pick, propsFactory } from '@/util'\n\n// Types\nimport type { PropType, TransitionProps } from 'vue'\nimport type { PieItem, TextTemplate } from './types'\n\nexport type VPieSlots = {\n  center: { total: number }\n  legend: {\n    isActive: (item: PieItem) => boolean\n    toggle: (item: PieItem) => void\n    items: PieItem[]\n    total: number\n  }\n  'legend-text': {\n    item: PieItem\n    total: number\n  }\n  title: never\n  tooltip: {\n    item: PieItem\n    total: number\n  }\n}\n\nexport const makeVPieProps = propsFactory({\n  title: String,\n  bgColor: String,\n  items: {\n    type: Array as PropType<Record<string, any> | { color?: string, pattern?: string }[]>,\n    default: () => [],\n  },\n  palette: {\n    type: Array as PropType<({ color?: string, pattern?: string } | string)[]>,\n    default: () => [],\n  },\n  itemKey: {\n    type: String,\n    default: 'key',\n  },\n  itemValue: {\n    type: String,\n    default: 'value',\n  },\n  itemTitle: {\n    type: String,\n    default: 'title',\n  },\n  size: {\n    type: [Number, String],\n    default: 250,\n  },\n  rotate: [Number, String],\n  gaugeCut: [Number, String],\n  legend: {\n    type: [Boolean, Object] as PropType<boolean | {\n      position?: 'left' | 'top' | 'right' | 'bottom'\n      textFormat?: TextTemplate\n    }>,\n    default: false,\n  },\n  tooltip: {\n    type: [Boolean, Object] as PropType<boolean | {\n      titleFormat?: TextTemplate\n      subtitleFormat?: TextTemplate\n      avatarSize?: number\n      transition?: string | boolean | TransitionProps\n      offset?: number\n    }>,\n    default: false,\n  },\n\n  ...makeDensityProps(),\n  ...pick(makeVPieSegmentProps(), [\n    'animation',\n    'gap',\n    'rounded',\n    'innerCut',\n    'hoverScale',\n    'hideSlice',\n    'reveal',\n  ]),\n}, 'VPie')\n\nexport const VPie = genericComponent<VPieSlots>()({\n  name: 'VPie',\n\n  directives: { vClickOutside },\n\n  props: makeVPieProps(),\n\n  setup (props, { slots }) {\n    const legendConfig = computed(() => ({\n      visible: !!props.legend,\n      position: 'bottom',\n      textFormat: '[title]',\n      ...(typeof props.legend === 'object' ? props.legend : {}),\n    }))\n\n    const { colorClasses, colorStyles } = useColor(() => ({ background: props.bgColor }))\n    const textColorStyles = toRef(() => pick(colorStyles.value, ['color', 'caretColor']))\n\n    const legendAvatarSize = toRef(() => ({ default: 20, comfortable: 18, compact: 16 }[props.density ?? 'default']))\n    const legendDirection = toRef(() => ['left', 'right'].includes(legendConfig.value.position) ? 'vertical' : 'horizontal')\n\n    const legendMode = toRef(() => !legendConfig.value.visible ? 'hidden' : legendConfig.value.position)\n\n    const legendTextFormatFunction = toRef(() => (item: PieItem) => {\n      return typeof legendConfig.value.textFormat === 'function'\n        ? legendConfig.value.textFormat(item)\n        : formatTextTemplate(legendConfig.value.textFormat, item)\n    })\n\n    const arcs = computed<PieItem[]>(() => {\n      // hidden items get (value: 0) to trigger disappearing animation\n      return props.items\n        .filter(Boolean)\n        .map((item: any, index: number) => {\n          return {\n            key: item[props.itemKey],\n            color: item.color ?? colorFromPalette(index),\n            value: item[props.itemValue],\n            title: String(item[props.itemTitle]),\n            pattern: item.pattern ?? patternFromPalette(index),\n            raw: item,\n          } as PieItem\n        })\n    })\n\n    const visibleItemsKeys = shallowRef<PieItem['key'][]>([])\n\n    watch(() => arcs.value.length, () => {\n      // reset when number of items changes\n      visibleItemsKeys.value = arcs.value.map(a => a.key)\n    }, { immediate: true })\n\n    const visibleItems = computed(() => {\n      // hidden items get (value: 0) to trigger disappearing animation\n      return arcs.value.map(item => {\n        return isVisible(item)\n          ? item\n          : { ...item, value: 0 }\n      })\n    })\n\n    const total = computed(() => visibleItems.value.reduce((sum, item) => sum + item.value, 0))\n\n    const gaugeCut = toRef(() => Number(props.gaugeCut ?? 0))\n    const gaugeOffset = computed(() => (1 - Math.cos(Math.PI * Math.min(90, gaugeCut.value / 2) / 180)) / 2)\n    const rotateDeg = computed(() => `${gaugeCut.value ? (180 + gaugeCut.value / 2) : (props.rotate ?? 0)}deg`)\n\n    function arcOffset (index: number) {\n      return visibleItems.value\n        .slice(0, index)\n        .reduce((acc, s) => acc + (total.value > 0 ? s.value / total.value : 0) * (360 - gaugeCut.value), 0)\n    }\n\n    function arcSize (v: number) { return v / total.value * (100 - gaugeCut.value / 3.6) }\n\n    function colorFromPalette (index: number) {\n      if (props.palette.length === 0) return undefined\n      const paletteItem = props.palette[index % props.palette.length]\n      return typeof paletteItem === 'object' ? paletteItem.color : paletteItem\n    }\n\n    function patternFromPalette (index: number) {\n      if (props.palette.length === 0) return undefined\n      const paletteItem = props.palette[index % props.palette.length]\n      return typeof paletteItem === 'object' ? paletteItem.pattern : undefined\n    }\n\n    function isVisible (item: PieItem) {\n      return visibleItemsKeys.value.includes(item.key)\n    }\n\n    function toggle (item: PieItem) {\n      if (isVisible(item)) {\n        visibleItemsKeys.value = visibleItemsKeys.value.filter(x => x !== item.key)\n      } else {\n        visibleItemsKeys.value = [...visibleItemsKeys.value, item.key]\n      }\n    }\n\n    const tooltipItem = shallowRef<PieItem | null>(null)\n    const tooltipVisible = shallowRef(false)\n    const tooltipTarget = shallowRef<[x: number, y: number]>([0, 0])\n\n    let mouseLeaveTimeout = null! as ReturnType<typeof setTimeout>\n\n    function setItemActive (item: PieItem, active: boolean) {\n      arcs.value.forEach(a => a.isActive = a.key === item.key && active)\n\n      if (props.tooltip) {\n        setTooltip(item, active)\n      }\n    }\n\n    function setTooltip (item: PieItem, active: boolean) {\n      clearTimeout(mouseLeaveTimeout)\n\n      if (active) {\n        tooltipVisible.value = true\n        tooltipItem.value = item\n      } else {\n        mouseLeaveTimeout = setTimeout(() => {\n          tooltipVisible.value = false\n\n          // intentionally reusing timeout here\n          mouseLeaveTimeout = setTimeout(() => {\n            tooltipItem.value = null\n          }, 500)\n        }, 100)\n      }\n    }\n\n    let frame = -1\n    function onSvgMousemove ({ clientX, clientY }: MouseEvent) {\n      cancelAnimationFrame(frame)\n      frame = requestAnimationFrame(() => {\n        tooltipTarget.value = [clientX, clientY]\n      })\n    }\n\n    function onSvgTouchstart ({ touches }: TouchEvent) {\n      if (!touches) return\n      const { clientX, clientY } = touches[0]\n      tooltipTarget.value = [clientX, clientY]\n    }\n\n    function onSvgClickOutside () {\n      arcs.value.forEach(a => a.isActive = false)\n      tooltipVisible.value = false\n    }\n\n    return () => {\n      const segmentProps = pick(props, [\n        'animation',\n        'gap',\n        'rounded',\n        'hideSlice',\n        'reveal',\n        'innerCut',\n        'hoverScale',\n      ])\n\n      const defaultTooltipTransition = {\n        name: 'fade-transition',\n        duration: 150,\n      }\n\n      const tooltipProps = {\n        item: tooltipItem.value,\n        modelValue: tooltipVisible.value,\n        titleFormat: typeof props.tooltip === 'object' ? props.tooltip.titleFormat : '[title]',\n        subtitleFormat: typeof props.tooltip === 'object' ? props.tooltip.subtitleFormat : '[value]',\n        transition: typeof props.tooltip === 'object' ? props.tooltip.transition : defaultTooltipTransition,\n        offset: typeof props.tooltip === 'object' ? props.tooltip.offset : 16,\n        target: tooltipTarget.value,\n      }\n\n      const legendDefaults = {\n        VChipGroup: {\n          direction: legendDirection.value,\n        },\n        VChip: {\n          density: props.density,\n        },\n        VAvatar: {\n          size: legendAvatarSize.value,\n        },\n      }\n\n      const tooltipDefaults = {\n        VAvatar: {\n          size: typeof props.tooltip === 'object' ? (props.tooltip.avatarSize ?? 28) : 28,\n        },\n      }\n\n      const avatarSlot = ({ item }: { item: PieItem }) => (\n        <VAvatar color={ item.color } start>\n          { item.pattern && (\n            <svg height=\"40\" width=\"40\">\n              <rect width=\"40\" height=\"40\" fill={ item.pattern } />\n            </svg>\n          )}\n        </VAvatar>\n      )\n\n      return (\n        <div\n          class={[\n            'v-pie',\n            `v-pie--legend-${legendMode.value}`,\n          ]}\n          style={{\n            '--v-pie-size': convertToUnit(props.size),\n          }}\n        >\n          { slots.title?.() ?? (props.title && (<div class=\"v-pie__title\">{ props.title }</div>)) }\n          <div\n            class={[\n              'v-pie__content',\n              colorClasses.value,\n            ]}\n            style={[\n              {\n                transform: `rotate(${rotateDeg.value})`,\n                marginBottom: `calc(-1 * ${convertToUnit(props.size)} * ${gaugeOffset.value})`,\n              },\n              textColorStyles.value,\n            ]}\n          >\n            <div\n              class={[\n                'v-pie__content-underlay',\n                colorClasses.value,\n              ]}\n              style={ colorStyles.value }\n            />\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              viewBox=\"0 0 100 100\"\n              class=\"v-pie__segments\"\n              onMousemove={ onSvgMousemove }\n              onTouchstart={ onSvgTouchstart }\n              v-click-outside={{ handler: onSvgClickOutside }}\n            >\n              { arcs.value.map((item, index) => (\n                <VPieSegment\n                  { ...segmentProps }\n                  key={ item.key }\n                  active={ item.isActive }\n                  color={ item.color }\n                  value={ isVisible(item) ? arcSize(item.value) : 0 }\n                  rotate={ arcOffset(index) }\n                  pattern={ item.pattern }\n                  onUpdate:active={ val => setItemActive(item, val) }\n                  onTouchend={ () => setItemActive(item, true) }\n                />\n              ))}\n            </svg>\n\n            <div\n              class=\"v-pie__center-content\"\n              style={{\n                transform: `translate(-50%, -50%)\n                  rotate(-${rotateDeg.value})\n                  translateY(calc(-100% * ${gaugeOffset.value}))`,\n              }}\n            >\n              <div>\n                { slots.center?.({ total: total.value }) }\n              </div>\n            </div>\n          </div>\n\n          { legendConfig.value.visible && (\n            <VDefaultsProvider key=\"legend\" defaults={ legendDefaults }>\n              <div class=\"v-pie__legend\">\n                { slots.legend?.({ isActive: isVisible, toggle, items: arcs.value, total: total.value }) ?? (\n                  <VChipGroup\n                    column\n                    multiple\n                    v-model={ visibleItemsKeys.value }\n                  >\n                    { arcs.value.map(item => (\n                      <VChip\n                        value={ item.key }\n                        v-slots={{\n                          prepend: () => avatarSlot({ item }),\n                          default: () => (\n                            <div class=\"v-pie__legend__text\">\n                              { slots['legend-text']?.({ item, total: total.value }) ?? legendTextFormatFunction.value(item) }\n                            </div>\n                          ),\n                        }}\n                      />\n                    ))}\n                  </VChipGroup>\n                )}\n              </div>\n            </VDefaultsProvider>\n          )}\n          { !!props.tooltip && (\n            <VDefaultsProvider defaults={ tooltipDefaults }>\n              <VPieTooltip\n                { ...tooltipProps }\n                v-slots={{\n                  default: slots.tooltip ? slotProps => slots.tooltip?.({ ...slotProps, total: total.value }) : undefined,\n                  prepend: avatarSlot,\n                }}\n              />\n            </VDefaultsProvider>\n          )}\n        </div>\n      )\n    }\n  },\n})\n\nexport type VPie = InstanceType<typeof VPie>\n"],"mappings":"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","ignoreList":[]}